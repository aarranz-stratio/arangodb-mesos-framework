# Vorbemerkung

Eine Resource kann statisch oder dynamisch fuer ein Framework
reserviert sein - oder eben ueberhaupt nicht reserviert. Eine
reservierte Disk-Resource kann persistent sein oder nicht.

Die Agency and der DBserver brauchen

- reservierte Resourcen fuer CPUS und MEM
- persistente Resourcen fuer DISK

Die Coordinatoren brauchen

- reservierte Resourcen fuer CPUS, MEM und DISK
- geshartes Filesystem fuer die Foxx-Apps

Es ist nicht moeglich eine Offer synchron zu reservieren. Wird ein
Offer abgegeben und es hat nicht reservierte Resourcen, so kann
versucht werden, diese Resourcen zu reservieren. Dies findet asynchron
statt und kann oder kann nicht funktionieren.

Falls ein Offer abgegeben wird, so wird fuer jeden Aspekt ueberprueft,
ob das Offer passt bzw. passen koennte, welches die notwendigen Aktionen
sind und die involvierten Resourcen.

Passt das Offer auf keinen Aspekt, wird es abgelehnt.

# Behandlung eines Offer

Wir wollen nur eine Rolle "arangodb" nach aussen geben, nicht drei
Rollen "arangodb-agency", "arangodb-coordinator", "arangodb-dbserver".

Die angeboten Offers werden gesammelt und regelmaessig ueberprueft.
Dabei wird wie folgt vorgegangen.

1. Die folgenden Schritte werden fuer die Agency, den DBserver und den
Coordinator (im folgenden Aspekt genannt) durchgefuehrt. Und zwar in
dieser Reihenfolgen, zuerst Schritte 2 bis x fuer Agency, danach alle
Schritte den DBserver, danach den Coordinator.

2. Braucht der Aspekt ein persistentes Volume, so wird in
_persistentOffer nach einer passenden Resource gesucht. Wird eine
solche gefunden, wird diese aus der Liste entfernt und es wird der
Prozess mit diesem Offer gestartet.

3. Wird kein Offer gefunden, so wird in _reservedOffer nach einer passenden
Resource gesucht. Wird eine passende Resource gefunden, so wird diese
aus der Liste entfernt. 

Braucht der Aspekt kein persistentes Volume, so wird der Prozess mit
diesem Offer gestartet.

Braucht der Aspekt ein persistentes Volume, so wird versucht mit
dieser Resource ein persistent Volume zu erzeugen. Fuer diesen Aspekt
wird der Prozess hier beendet. Es wird davon ausgegangen, dass ein
neues Offer nach einiger Zeit abgegeben wird.

4. Wird kein Offer gefunden, so wird in _unreservedOffer nach einer
passend Resource gesucht. Wird eine solche gefunden, wird diese aus
der Liste entfernt und es wird versucht ein reservierte Resource zu
erzeugen.  Fuer diesen Aspekt wird der Prozess hier beendet. Es wird
davon ausgegangen, dass ein neues Offer nach einiger Zeit abgegeben
wird.

